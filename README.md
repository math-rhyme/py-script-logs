# Содержание

- [Запуск скрипта](#запуск-скрипта)
  - [Подготовка](#подготовка)
  - [Запуск скрипта и тестов](#запуск-скрипта-и-тестов)
- [Makefile](#makefile)
- [Параметры скрипта](#параметры-скрипта)
- [Примеры запуска и вывода скрипта](#примеры-запуска-и-вывода-скрипта)
  - [1. Запуск с параметрами из условия](#1-запуск-с-параметрами-из-условия)
  - [2. Запуск с неверной датой](#2-запуск-с-неверной-датой)
  - [3. Запуск с фильтром по дате](#3-запуск-с-фильтром-по-дате)
  - [4. Запуск с пропущенным параметром файла](#4-запуск-с-пропущенным-параметром-файла)
  - [5. Запуск с несуществующим файлом](#5-запуск-с-несуществующим-файлом)



# Запуск скрипта

### Подготовка

1. создать и активировать виртуальное окружение:
    ```
    python3 -m venv .venv
    source .venv/bin/activate
    ```
2. установить зависимости (вызов из папки `src`):
    ```
    pip install -r requirements.txt
    ```
    или, если взывать вне папки `src`:
    ```
    pip install -r src/requirements.txt
    ```
3. перейти в директорию `src`. можно запускать скрипт и тесты (примеры команд далее)

---

### Запуск скрипта и тестов

После настройки окружения можно проверить работу скрипта на тестовых файлах командой:
```
python3 main.py --file example1.log example2.log --report average
```

После настройки и проверки работы скрипта можно запустить тесты командой:
```
pytest --cov=main test_main.py
```

Пример вывода:
```
======================= test session starts ========================
platform linux -- Python 3.12.3, pytest-8.4.1, pluggy-1.6.0
rootdir: /mnt/c/Users/Rose3/test_tasks/script_logs_py/src
plugins: cov-6.2.1
collected 13 items                                                 

test_main.py .............                                   [100%]

========================== tests coverage ==========================
_________ coverage: platform linux, python 3.12.3-final-0 __________

Name      Stmts   Miss  Cover
-----------------------------
main.py      79     12    85%
-----------------------------
TOTAL        79     12    85%
======================== 13 passed in 0.90s ========================
```

# Makefile

Также можно использовать Makefile для упрощения запуска:

- `make install` — установка зависимостей  
- `make run` — запуск скрипта с параметрами из условия задания  
- `make test` — запуск тестов с покрытием
- `make clean` — очистка временных файлов тестов  
- `make help` — вывод в консоль списка доступных таргетов  
- `make html_report` — запуск тестов + генерация HTML-отчёта по покрытию

Необходимо выполнить `make <таргет>` в корне проекта для запуска.



# Параметры скрипта

| Параметр | Аргументы |
| --- | --- |
| `-f`, `--file` | файлы для чтения. произвольное количество. минимум один файл. |
| `-r`, `--report` | тип возвращаемого отчёта. произвольное количество. минимум один тип. |
| `-d`, `--date` | дата, по которой сортируются данные. необязательный параметр. не более одного аргумента. |



# Примеры запуска и вывода скрипта

### 1. Запуск с параметрами из условия:
```
python3 main.py -f example1.log example2.log -r average
```

Вывод:
```
|    | header                   |   total |   avg_response_time |
|----|--------------------------|---------|---------------------|
|  0 | /api/homeworks/...       |   55312 |               0.093 |
|  1 | /api/context/...         |   43928 |               0.019 |
|  2 | /api/specializations/... |    8335 |               0.052 |
|  3 | /api/challenges/...      |    1476 |               0.078 |
|  4 | /api/users/...           |    1447 |               0.066 |

```

---
### 2. Запуск с неверной датой:
```
python3 main.py -f example1.log -r average -d 2025-22-06
```

Вывод:
```
Invalid date format: 2025-22-06. Please, use YYYY-MM-DD.
```

---
### 3. Запуск с фильтром по дате:
```
python3 main.py --file example1.log --report average --date 2025-06-22
```

Вывод:
```
|    | header                   |   total |   avg_response_time |
|----|--------------------------|---------|---------------------|
|  0 | /api/homeworks/...       |      71 |               0.158 |
|  1 | /api/context/...         |      21 |               0.043 |
|  2 | /api/specializations/... |       6 |               0.035 |
|  3 | /api/users/...           |       1 |               0.072 |
|  4 | /api/challenges/...      |       1 |               0.056 |
```
---
### 4. Запуск с пропущенным параметром файла:
```
python3 main.py --report average
```
Вывод:
```
Please, add at least one file with --file.
```
---
### 5. Запуск с несуществующим файлом:
```
python3 main.py --file nosuchafile.log --report average
```
Вывод:
```
Error: File 'nosuchafile.log' not found.
No data to display for your request.
```